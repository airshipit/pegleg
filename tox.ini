[tox]
envlist = py35, py36, pep8, docs
minversion = 2.3.1
# Allows docs to be built without setup.py having to exist. Requires that
# usedevelop be False as well (which it is by default).
skipsdist = True

[testenv]
setenv = VIRTUAL_ENV={envdir}
         LANGUAGE=en_US
         LC_ALL=en_US.utf-8
passenv = http_proxy HTTP_PROXY https_proxy HTTPS_PROXY no_proxy NO_PROXY

[testenv:venv]
commands = {posargs}

[testenv:py35]
basepython = python3.5
commands =
    # Run all unit tests under src/bin/pegleg
    tox -c src/bin/pegleg/tox.ini -e py35
whitelist_externals = tox

[testenv:py36]
basepython = python3.6
commands =
    # Run all unit tests under src/bin/pegleg
    tox -c src/bin/pegleg/tox.ini -e py36
whitelist_externals = tox

[testenv:fmt]
basepython = python3
commands =
    tox -c src/bin/pegleg/tox.ini -e fmt
whitelist_externals = tox

[testenv:pep8]
basepython = python3
commands =
    tox -c src/bin/pegleg/tox.ini -e pep8
whitelist_externals = tox

[testenv:docs]
basepython = python3
deps =
    -r{toxinidir}/src/bin/pegleg/requirements.txt
    -r{toxinidir}/doc/requirements.txt
commands =
    rm -rf doc/build
    sphinx-build -b html doc/source doc/build -n -W -v
whitelist_externals = rm
